@()(implicit user: User)

@swimmer(swimmer: Swimmer) = {
<h3>@swimmer.fullName</h3>
<table class="table table-bordered table-condensed">
<thead><tr><th>Event</th><th>Meet</th><th>Time</th><th>Delta</th></tr></thead>
<tbody>
@swimmer.results.map { result =>
    @result.delta.map { d => @defining(d match { 
      case x if x.startsWith("+") => "error"
      case x if x.startsWith("-") => "success"
      case other => ""
    }) { rowClass => <tr class="@rowClass"> }
   }
	<td>@result.event</td><td>@result.meet</td><td>@result.finalTime</td><td>@result.delta</td></tr> 
}
</tbody>
</table>
}

@main(Some(user)){
    <h1>Welcome @user.fullName</h1>
    <br/>
    <h2>Your Swimmers <a href="#" id="addButton" class="btn btn-primary" title="Add a swimmer"><i class="icon-plus-sign icon-white"></i>Add</a></h2>
    <div id="addSwimmer" style="display:none">
		<form class="form-horizontal" action="@routes.ManageSwimmers.add" method="POST">
			<div class="control-group">
				<label class="control-label" for="firstName">First Name</label>
				<div class="controls">
					<input type="text" name="firstName" placeholder="">
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="lastName">Last Name</label>
				<div class="controls">
					<input type="text" name="lastName" placeholder="">
				</div>
			</div>
			<div class="control-group">
				<div class="controls">
					<input type="submit" class="btn" value="Follow" />
				</div>
			</div>
		</form>
    </div>
    
    @user.watching.map { id => @Swimmer.findById(id).map { s => @swimmer(s) }}
    
    @activeMeets()
    
    
<script>
$('#addButton').click(function() { $('#addSwimmer').toggle(300);});
</script>
}
	